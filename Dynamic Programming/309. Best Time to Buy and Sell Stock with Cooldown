class Solution {
    public int backtrack(int prices[], int idx, int buy, int dp[][], int n){
        if(idx>=n){
            return 0;
        }
        if(dp[idx][buy] != -1){
            return dp[idx][buy];
        }
        int price=0;
        if(buy == 1){
            price = Math.max(-prices[idx] + backtrack(prices, idx+1, 0, dp, n),
                            0 + backtrack(prices, idx+1, 1, dp, n)
            );
        }
        else{
            price = Math.max(prices[idx] + backtrack(prices, idx+2, 1, dp, n),
                            0 + backtrack(prices, idx+1, 0, dp, n)
            );
        }

        return dp[idx][buy] = price;
    }
    public int maxProfit(int[] prices) {
        int n = prices.length;
        int dp[][] = new int[n][2];
        for(int i[]: dp){
            Arrays.fill(i, -1);
        }
        return backtrack(prices, 0, 1, dp, n);
    }
}
